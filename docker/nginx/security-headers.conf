# Observer-Eye Platform - Security Headers Configuration
# Comprehensive security headers for all environments

# Basic Security Headers
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Content Security Policy (Development - Relaxed)
add_header Content-Security-Policy "
    default-src 'self';
    script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:;
    style-src 'self' 'unsafe-inline';
    img-src 'self' data: blob: https:;
    font-src 'self' data:;
    connect-src 'self' ws: wss:;
    media-src 'self';
    object-src 'none';
    child-src 'self';
    frame-ancestors 'self';
    form-action 'self';
    base-uri 'self';
" always;

# Feature Policy / Permissions Policy
add_header Permissions-Policy "
    geolocation=(),
    microphone=(),
    camera=(),
    magnetometer=(),
    gyroscope=(),
    speaker=(),
    vibrate=(),
    fullscreen=(self),
    payment=()
" always;

# Cross-Origin Policies
add_header Cross-Origin-Embedder-Policy "require-corp" always;
add_header Cross-Origin-Opener-Policy "same-origin" always;
add_header Cross-Origin-Resource-Policy "same-origin" always;

# Cache Control for Security
add_header Cache-Control "no-cache, no-store, must-revalidate" always;
add_header Pragma "no-cache" always;

# Remove Server Information
server_tokens off;
more_clear_headers Server;
more_clear_headers X-Powered-By;